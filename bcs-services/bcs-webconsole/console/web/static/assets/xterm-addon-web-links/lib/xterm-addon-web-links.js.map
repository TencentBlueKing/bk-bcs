{"version":3,"file":"xterm-addon-web-links.js","mappings":"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","sources":["webpack://WebLinksAddon/webpack/universalModuleDefinition","webpack://WebLinksAddon/./src/WebLinkProvider.ts","webpack://WebLinksAddon/webpack/bootstrap","webpack://WebLinksAddon/./src/WebLinksAddon.ts"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"WebLinksAddon\"] = factory();\n\telse\n\t\troot[\"WebLinksAddon\"] = factory();\n})(self, function() {\nreturn ","/**\n * Copyright (c) 2019 The xterm.js authors. All rights reserved.\n * @license MIT\n */\n\nimport { ILinkProvider, ILink, Terminal, IViewportRange } from 'xterm';\n\nexport interface ILinkProviderOptions {\n  hover?(event: MouseEvent, text: string, location: IViewportRange): void;\n  leave?(event: MouseEvent, text: string): void;\n  urlRegex?: RegExp;\n}\n\nexport class WebLinkProvider implements ILinkProvider {\n\n  constructor(\n    private readonly _terminal: Terminal,\n    private readonly _regex: RegExp,\n    private readonly _handler: (event: MouseEvent, uri: string) => void,\n    private readonly _options: ILinkProviderOptions = {}\n  ) {\n\n  }\n\n  public provideLinks(y: number, callback: (links: ILink[] | undefined) => void): void {\n    const links = LinkComputer.computeLink(y, this._regex, this._terminal, this._handler);\n    callback(this._addCallbacks(links));\n  }\n\n  private _addCallbacks(links: ILink[]): ILink[] {\n    return links.map(link => {\n      link.leave = this._options.leave;\n      link.hover = (event: MouseEvent, uri: string): void => {\n        if (this._options.hover) {\n          const { range } = link;\n          this._options.hover(event, uri, range);\n        }\n      };\n      return link;\n    });\n  }\n}\n\nexport class LinkComputer {\n  public static computeLink(y: number, regex: RegExp, terminal: Terminal, activate: (event: MouseEvent, uri: string) => void): ILink[] {\n    const rex = new RegExp(regex.source, (regex.flags || '') + 'g');\n\n    const [line, startLineIndex] = LinkComputer._translateBufferLineToStringWithWrap(y - 1, false, terminal);\n\n    let match;\n    let stringIndex = -1;\n    const result: ILink[] = [];\n\n    while ((match = rex.exec(line)) !== null) {\n      const text = match[1];\n      if (!text) {\n        // something matched but does not comply with the given matchIndex\n        // since this is most likely a bug the regex itself we simply do nothing here\n        console.log('match found without corresponding matchIndex');\n        break;\n      }\n\n      // Get index, match.index is for the outer match which includes negated chars\n      // therefore we cannot use match.index directly, instead we search the position\n      // of the match group in text again\n      // also correct regex and string search offsets for the next loop run\n      stringIndex = line.indexOf(text, stringIndex + 1);\n      rex.lastIndex = stringIndex + text.length;\n      if (stringIndex < 0) {\n        // invalid stringIndex (should not have happened)\n        break;\n      }\n\n      let endX = stringIndex + text.length;\n      let endY = startLineIndex + 1;\n\n      while (endX > terminal.cols) {\n        endX -= terminal.cols;\n        endY++;\n      }\n\n      let startX = stringIndex + 1;\n      let startY = startLineIndex + 1;\n      while (startX > terminal.cols) {\n        startX -= terminal.cols;\n        startY++;\n      }\n\n      const range = {\n        start: {\n          x: startX,\n          y: startY\n        },\n        end: {\n          x: endX,\n          y: endY\n        }\n      };\n\n      result.push({ range, text, activate });\n    }\n\n    return result;\n  }\n\n  /**\n   * Gets the entire line for the buffer line\n   * @param line The line being translated.\n   * @param trimRight Whether to trim whitespace to the right.\n   * @param terminal The terminal\n   */\n  private static _translateBufferLineToStringWithWrap(lineIndex: number, trimRight: boolean, terminal: Terminal): [string, number] {\n    let lineString = '';\n    let lineWrapsToNext: boolean;\n    let prevLinesToWrap: boolean;\n\n    do {\n      const line = terminal.buffer.active.getLine(lineIndex);\n      if (!line) {\n        break;\n      }\n\n      if (line.isWrapped) {\n        lineIndex--;\n      }\n\n      prevLinesToWrap = line.isWrapped;\n    } while (prevLinesToWrap);\n\n    const startLineIndex = lineIndex;\n\n    do {\n      const nextLine = terminal.buffer.active.getLine(lineIndex + 1);\n      lineWrapsToNext = nextLine ? nextLine.isWrapped : false;\n      const line = terminal.buffer.active.getLine(lineIndex);\n      if (!line) {\n        break;\n      }\n      lineString += line.translateToString(!lineWrapsToNext && trimRight).substring(0, terminal.cols);\n      lineIndex++;\n    } while (lineWrapsToNext);\n\n    return [lineString, startLineIndex];\n  }\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","/**\n * Copyright (c) 2019 The xterm.js authors. All rights reserved.\n * @license MIT\n */\n\nimport { Terminal, ITerminalAddon, IDisposable } from 'xterm';\nimport { ILinkProviderOptions, WebLinkProvider } from './WebLinkProvider';\n\nconst protocolClause = '(https?:\\\\/\\\\/)';\nconst domainCharacterSet = '[\\\\da-z\\\\.-]+';\nconst negatedDomainCharacterSet = '[^\\\\da-z\\\\.-]+';\nconst domainBodyClause = '(' + domainCharacterSet + ')';\nconst tldClause = '([a-z\\\\.]{2,18})';\nconst ipClause = '((\\\\d{1,3}\\\\.){3}\\\\d{1,3})';\nconst localHostClause = '(localhost)';\nconst portClause = '(:\\\\d{1,5})';\nconst hostClause = '((' + domainBodyClause + '\\\\.' + tldClause + ')|' + ipClause + '|' + localHostClause + ')' + portClause + '?';\nconst pathCharacterSet = '(\\\\/[\\\\/\\\\w\\\\.\\\\-%~:+@]*)*([^:\"\\'\\\\s])';\nconst pathClause = '(' + pathCharacterSet + ')?';\nconst queryStringHashFragmentCharacterSet = '[0-9\\\\w\\\\[\\\\]\\\\(\\\\)\\\\/\\\\?\\\\!#@$%&\\'*+,:;~\\\\=\\\\.\\\\-]*';\nconst queryStringClause = '(\\\\?' + queryStringHashFragmentCharacterSet + ')?';\nconst hashFragmentClause = '(#' + queryStringHashFragmentCharacterSet + ')?';\nconst negatedPathCharacterSet = '[^\\\\/\\\\w\\\\.\\\\-%]+';\nconst bodyClause = hostClause + pathClause + queryStringClause + hashFragmentClause;\nconst start = '(?:^|' + negatedDomainCharacterSet + ')(';\nconst end = ')($|' + negatedPathCharacterSet + ')';\nconst strictUrlRegex = new RegExp(start + protocolClause + bodyClause + end);\n\nfunction handleLink(event: MouseEvent, uri: string): void {\n  const newWindow = window.open();\n  if (newWindow) {\n    try {\n      newWindow.opener = null;\n    } catch {\n      // no-op, Electron can throw\n    }\n    newWindow.location.href = uri;\n  } else {\n    console.warn('Opening link blocked as opener could not be cleared');\n  }\n}\n\nexport class WebLinksAddon implements ITerminalAddon {\n  private _terminal: Terminal | undefined;\n  private _linkProvider: IDisposable | undefined;\n\n  constructor(\n    private _handler: (event: MouseEvent, uri: string) => void = handleLink,\n    private _options: ILinkProviderOptions = {}\n  ) {\n  }\n\n  public activate(terminal: Terminal): void {\n    this._terminal = terminal;\n    const options = this._options as ILinkProviderOptions;\n    const regex = options.urlRegex || strictUrlRegex;\n    this._linkProvider = this._terminal.registerLinkProvider(new WebLinkProvider(this._terminal, regex, this._handler, options));\n  }\n\n  public dispose(): void {\n    this._linkProvider?.dispose();\n  }\n}\n"],"names":["root","factory","exports","module","define","amd","self","constructor","_terminal","_regex","_handler","_options","provideLinks","y","callback","links","LinkComputer","computeLink","this","_addCallbacks","map","link","leave","hover","event","uri","range","static","regex","terminal","activate","rex","RegExp","source","flags","line","startLineIndex","_translateBufferLineToStringWithWrap","match","stringIndex","result","exec","text","console","log","indexOf","lastIndex","length","endX","endY","cols","startX","startY","start","x","end","push","lineIndex","trimRight","lineWrapsToNext","prevLinesToWrap","lineString","buffer","active","getLine","isWrapped","nextLine","translateToString","substring","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","strictUrlRegex","handleLink","newWindow","window","open","opener","location","href","warn","options","urlRegex","_linkProvider","registerLinkProvider","WebLinkProvider","dispose"],"sourceRoot":""}