#### 前置初始化

1. ##### 前置初始化在节点添加流程中执行位置

提交添加节点任务 ---> 节点重装操作系统 ---> **执行前置初始化** ---> 部署kubelet服务 ---> 执行后置初始化 ---> 开启节点调度 ---> 添加节点完成

2. ##### 参数说明

- 前置初始化脚本会在添加节点列表中的每一台服务器上执行
- 前置初始化不支持内置变量

3. ##### 使用场景

- DaemonSet进程启动前依赖Woker节点上的特殊目录，需要提前创建
- DaemonSet进程需要特殊内核参数，进程启动前需要先在Woker节点上配置
- DaemonSet以hostnetwork模式启动，继承Woker节点的/etc/resolv.conf，且需要配置特殊nameserver
- 业务其它特殊配置

4. ##### 使用示例

- Woker节点上创建业务目录

```bash
mkdir /data/logs
```

- 调整Woker节点内核参数

```bash
echo 'net.core.rmem_default = 52428800
net.core.rmem_max = 52428800
net.core.wmem_default = 52428800
net.core.wmem_max = 52428800' >>/etc/sysctl.conf
sysctl -p
```

- 修改节点主机的/etc/resolv.conf

```bash
mkdir -p /data/backup
cp -a /etc/resolv.conf /data/backup/resolv.conf_$(date +%Y%m%d%H%M%S)
echo 'nameserver 8.8.8.8
nameserver 114.114.114.114' >/etc/resolv.conf
```
#### 后置初始化

1. ##### 后置初始化在节点添加流程中执行位置

提交添加节点任务 ---> 节点重装操作系统 ---> 执行前置初始化 ---> 部署kubelet服务 ---> **执行后置初始化** ---> 开启节点调度 ---> 添加节点完成

2. ##### 参数说明

- 简单执行脚本行会在添加节点列表中的每一台服务器上执行
- 简单脚本执行中可使用内置变量，例如要使用添加节点列表可以使用内置变量{{ .NodeIPList }}
- 标准运维流程执行参数类型暂时只支持输入框类型的参数，请勿使用其它类型的参数
- 标准运维流程执行参数中可以使用内置变量，例如要使用添加节点列表可以使用内置变量{{ .NodeIPList }}
- 标准运维流程执行如果想使用标准运维参数的默认值，在节点模版配置中把参数留空即可

3. ##### 使用场景

- 后置初始化功能没有固定场景，主要是让业务根据自身场景来实现一套自定义操作

- 简单脚本执行与前置初始化一样，适用于简单初始化场景，逻辑建议不要过于复杂

- 标准运维流程执行，使用蓝鲸标准运维应用作为流程执行引擎，适用于复杂的初始化场景

#### 节点回收前清理配置

1. ##### 节点回收前清理配置在节点缩容流程中执行位置
提交缩容节点任务 ---> 设置节点不可调度 ---> 驱逐被删除节点上的Pod ---> **执行节点回收前清理配置作业** ---> 节点从集群移除 ---> 节点转移模块或回收 ---> 缩容节点完成

2. ##### 参数说明

- 简单脚本执行会在添加节点列表中的每一台服务器上执行
- 简单脚本执行中可使用内置变量，例如要使用添加节点列表可以使用内置变量{{ .NodeIPList }}
- 标准运维流程执行参数类型暂时只支持输入框类型的参数，请勿使用其它类型的参数
- 标准运维流程执行参数中可以使用内置变量，例如要使用添加节点列表可以使用内置变量{{ .NodeIPList }}
- 标准运维流程执行如果想使用标准运维参数的默认值，在节点模版配置中把参数留空即可

3. ##### 使用场景
- 节点缩容前清理业务数据或日志